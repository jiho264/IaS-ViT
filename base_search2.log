Namespace(model='deit_tiny', dataset='data/ImageNet', calib_batchsize=128, val_batchsize=200, num_workers=8, device='cuda', print_freq=100, seed=0, w_bits=4, a_bits=4, w_cw=True, a_cw=True, iter=1000, warmup=0.2)
Building dataloader ...
Building model ...
quantization settings: {'n_bits': 4, 'channel_wise': True} | {'n_bits': 4, 'channel_wise': True}

Stage One, Q-Act, FP-W
Init quantization parameters of act
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
Best base: 1.20000, Best bias: 0.01000, Best score: 0.00001
Best base: 1.20000, Best bias: 0.00500, Best score: 0.00000
Best base: 1.20000, Best bias: 0.01000, Best score: 0.00001
Best base: 1.20000, Best bias: 0.00500, Best score: 0.00001
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
Best base: 1.20000, Best bias: 0.01000, Best score: 0.00001
Best base: 1.20000, Best bias: 0.01000, Best score: 0.00001
Best base: 1.20000, Best bias: 0.01000, Best score: 0.00000
Best base: 1.40000, Best bias: 0.00500, Best score: 0.00000
Start optimization
Reconstruction for layer proj
Total loss:	0.000 	count=500
Total loss:	0.000 	count=1000
Reconstruction for block 0
Total loss:	3.707 	count=500
Total loss:	3.688 	count=1000
Reconstruction for block 1
Total loss:	1.099 	count=500
Total loss:	1.083 	count=1000
Reconstruction for block 2
Total loss:	0.899 	count=500
Total loss:	0.877 	count=1000
Reconstruction for block 3
Total loss:	0.717 	count=500
Total loss:	0.697 	count=1000
Reconstruction for block 4
Total loss:	0.673 	count=500
Total loss:	0.655 	count=1000
Reconstruction for block 5
Total loss:	0.792 	count=500
Total loss:	0.781 	count=1000
Reconstruction for block 6
Total loss:	1.113 	count=500
Total loss:	1.089 	count=1000
Reconstruction for block 7
Total loss:	1.312 	count=500
Total loss:	1.285 	count=1000
Reconstruction for block 8
Total loss:	1.703 	count=500
Total loss:	1.637 	count=1000
Reconstruction for block 9
Total loss:	1.549 	count=500
Total loss:	1.509 	count=1000
Reconstruction for block 10
Total loss:	0.755 	count=500
Total loss:	0.733 	count=1000
Reconstruction for block 11
Total loss:	0.519 	count=500
Total loss:	0.505 	count=1000
Reconstruction for layer head
Total loss:	2.635 	count=500
Total loss:	1.983 	count=1000
Acc after Stage One: 
Test: [0/250]	Time 2.612 (2.612)	Loss 1.0333 (1.0333)	Prec@1 78.000 (78.000)	Prec@5 96.000 (96.000)
Test: [100/250]	Time 0.200 (0.235)	Loss 2.0480 (1.2511)	Prec@1 51.000 (72.129)	Prec@5 82.000 (92.248)
Test: [200/250]	Time 0.200 (0.220)	Loss 0.8764 (1.5720)	Prec@1 83.500 (66.092)	Prec@5 95.000 (87.856)
 * Prec@1 65.482 Prec@5 87.458 Time 54.222

Stage Two, reparameterization
Stage Three, Q-Act, Q-W
Init quantization parameters of weight
re optimization
Reconstruction for layer proj
Total loss:	1.770 	count=500
Total loss:	0.331 	count=1000
Reconstruction for block 0
Total loss:	5.681 	count=500
Total loss:	4.520 	count=1000
Reconstruction for block 1
Total loss:	4.507 	count=500
Total loss:	4.214 	count=1000
Reconstruction for block 2
Total loss:	4.960 	count=500
Total loss:	4.592 	count=1000
Reconstruction for block 3
Total loss:	5.689 	count=500
Total loss:	5.431 	count=1000
Reconstruction for block 4
Total loss:	6.511 	count=500
Total loss:	6.418 	count=1000
Reconstruction for block 5
Total loss:	8.316 	count=500
Total loss:	7.934 	count=1000
Reconstruction for block 6
Total loss:	10.595 	count=500
Total loss:	10.216 	count=1000
Reconstruction for block 7
Total loss:	14.993 	count=500
Total loss:	14.594 	count=1000
Reconstruction for block 8
Total loss:	22.201 	count=500
Total loss:	21.730 	count=1000
Reconstruction for block 9
Total loss:	29.672 	count=500
Total loss:	30.883 	count=1000
Reconstruction for block 10
Total loss:	35.049 	count=500
Total loss:	34.249 	count=1000
Reconstruction for block 11
Total loss:	35.230 	count=500
Total loss:	35.169 	count=1000
Reconstruction for layer head
Total loss:	119.377 	count=500
Total loss:	104.526 	count=1000
Acc after re optimization
Test: [0/250]	Time 2.338 (2.338)	Loss 1.1960 (1.1960)	Prec@1 71.500 (71.500)	Prec@5 94.000 (94.000)
Test: [100/250]	Time 0.207 (0.238)	Loss 2.2973 (1.4261)	Prec@1 50.500 (70.426)	Prec@5 79.000 (91.396)
Test: [200/250]	Time 0.207 (0.224)	Loss 0.9328 (1.7440)	Prec@1 85.500 (64.475)	Prec@5 96.500 (86.856)
 * Prec@1 63.662 Prec@5 86.356 Time 55.225

