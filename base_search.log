Namespace(model='deit_tiny', dataset='data/ImageNet', calib_batchsize=1024, val_batchsize=200, num_workers=8, device='cuda', print_freq=100, seed=0, w_bits=4, a_bits=4, w_cw=True, a_cw=True, iter=1000, warmup=0.2)
Building dataloader ...
Building model ...
quantization settings: {'n_bits': 4, 'channel_wise': True} | {'n_bits': 4, 'channel_wise': True}

Stage One, Q-Act, FP-W
Init quantization parameters of act
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
Best base: 1.20000, Best bias: 0.01000, Best score: 0.00001
Best base: 1.20000, Best bias: 0.00500, Best score: 0.00000
Best base: 1.20000, Best bias: 0.01000, Best score: 0.00001
Best base: 1.20000, Best bias: 0.00500, Best score: 0.00001
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
Best base: 1.20000, Best bias: 0.01000, Best score: 0.00001
Best base: 1.20000, Best bias: 0.01000, Best score: 0.00001
Best base: 1.20000, Best bias: 0.01000, Best score: 0.00000
Best base: 1.40000, Best bias: 0.00500, Best score: 0.00000
Start optimization
Reconstruction for layer proj
Total loss:	0.000 	count=500
Total loss:	0.000 	count=1000
Reconstruction for block 0
Total loss:	4.085 	count=500
Total loss:	3.852 	count=1000
Reconstruction for block 1
Total loss:	1.210 	count=500
Total loss:	1.265 	count=1000
Reconstruction for block 2
Total loss:	0.971 	count=500
Total loss:	0.954 	count=1000
Reconstruction for block 3
Total loss:	0.773 	count=500
Total loss:	0.762 	count=1000
Reconstruction for block 4
Total loss:	0.749 	count=500
Total loss:	0.744 	count=1000
Reconstruction for block 5
Total loss:	0.899 	count=500
Total loss:	0.887 	count=1000
Reconstruction for block 6
Total loss:	1.310 	count=500
Total loss:	1.292 	count=1000
Reconstruction for block 7
Total loss:	1.642 	count=500
Total loss:	1.526 	count=1000
Reconstruction for block 8
Total loss:	2.192 	count=500
Total loss:	2.012 	count=1000
Reconstruction for block 9
Total loss:	1.987 	count=500
Total loss:	1.943 	count=1000
Reconstruction for block 10
Total loss:	0.952 	count=500
Total loss:	0.941 	count=1000
Reconstruction for block 11
Total loss:	0.708 	count=500
Total loss:	0.730 	count=1000
Reconstruction for layer head
Total loss:	18.255 	count=500
Total loss:	21.341 	count=1000
Acc after Stage One: 
Test: [0/250]	Time 2.821 (2.821)	Loss 0.9583 (0.9583)	Prec@1 78.000 (78.000)	Prec@5 97.500 (97.500)
Test: [100/250]	Time 0.327 (0.353)	Loss 2.0794 (1.2139)	Prec@1 48.500 (72.614)	Prec@5 79.500 (92.450)
Test: [200/250]	Time 0.324 (0.339)	Loss 0.8804 (1.5309)	Prec@1 85.000 (66.562)	Prec@5 94.000 (88.172)
 * Prec@1 66.034 Prec@5 87.798 Time 84.091

Stage Two, reparameterization
Stage Three, Q-Act, Q-W
Init quantization parameters of weight
re optimization
Reconstruction for layer proj
Total loss:	1.929 	count=500
Total loss:	0.389 	count=1000
Reconstruction for block 0
Total loss:	5.365 	count=500
Total loss:	4.620 	count=1000
Reconstruction for block 1
Total loss:	4.630 	count=500
Total loss:	4.778 	count=1000
Reconstruction for block 2
Total loss:	5.383 	count=500
Total loss:	5.186 	count=1000
Reconstruction for block 3
Total loss:	6.386 	count=500
Total loss:	6.290 	count=1000
Reconstruction for block 4
Total loss:	8.058 	count=500
Total loss:	7.638 	count=1000
Reconstruction for block 5
Total loss:	10.373 	count=500
Total loss:	10.086 	count=1000
Reconstruction for block 6
Total loss:	14.459 	count=500
Total loss:	14.517 	count=1000
Reconstruction for block 7
Total loss:	21.217 	count=500
Total loss:	20.741 	count=1000
Reconstruction for block 8
Total loss:	35.665 	count=500
Total loss:	34.186 	count=1000
Reconstruction for block 9
Total loss:	51.406 	count=500
Total loss:	51.254 	count=1000
Reconstruction for block 10
Total loss:	59.840 	count=500
Total loss:	57.673 	count=1000
Reconstruction for block 11
Total loss:	59.575 	count=500
Total loss:	59.641 	count=1000
Reconstruction for layer head
Total loss:	319.545 	count=500
Total loss:	285.975 	count=1000
Acc after re optimization
Test: [0/250]	Time 3.005 (3.005)	Loss 1.0865 (1.0865)	Prec@1 76.500 (76.500)	Prec@5 95.000 (95.000)
Test: [100/250]	Time 0.341 (0.365)	Loss 2.1344 (1.3570)	Prec@1 52.000 (72.040)	Prec@5 84.000 (91.980)
Test: [200/250]	Time 0.335 (0.351)	Loss 0.9945 (1.6621)	Prec@1 83.000 (66.204)	Prec@5 95.000 (87.771)
 * Prec@1 65.568 Prec@5 87.478 Time 87.203

