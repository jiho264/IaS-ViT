Namespace(model='deit_tiny', dataset='data/ImageNet', calib_batchsize=128, val_batchsize=200, num_workers=8, device='cuda', print_freq=100, seed=0, w_bits=4, a_bits=4, w_cw=True, a_cw=True, iter=1000, warmup=0.2)
Building dataloader ...
Building model ...
quantization settings: {'n_bits': 4, 'channel_wise': True} | {'n_bits': 4, 'channel_wise': True}

Stage One, Q-Act, FP-W
Init quantization parameters of act
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
Best base: 1.30000, Best bias: 0.00500, Best score: 0.00001
Best base: 1.30000, Best bias: 0.00500, Best score: 0.00000
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
Best base: 1.30000, Best bias: 0.00500, Best score: 0.00001
Best base: 1.30000, Best bias: 0.00500, Best score: 0.00001
Best base: 1.40000, Best bias: 0.00500, Best score: 0.00000
Start optimization
Reconstruction for layer proj
Total loss:	0.000 	count=500
Total loss:	0.000 	count=1000
Reconstruction for block 0
Total loss:	3.707 	count=500
Total loss:	3.688 	count=1000
Reconstruction for block 1
Total loss:	1.099 	count=500
Total loss:	1.083 	count=1000
Reconstruction for block 2
Total loss:	0.899 	count=500
Total loss:	0.877 	count=1000
Reconstruction for block 3
Total loss:	0.725 	count=500
Total loss:	0.705 	count=1000
Reconstruction for block 4
Total loss:	0.680 	count=500
Total loss:	0.663 	count=1000
Reconstruction for block 5
Total loss:	0.836 	count=500
Total loss:	0.821 	count=1000
Reconstruction for block 6
Total loss:	1.160 	count=500
Total loss:	1.135 	count=1000
Reconstruction for block 7
Total loss:	1.307 	count=500
Total loss:	1.282 	count=1000
Reconstruction for block 8
Total loss:	1.781 	count=500
Total loss:	1.709 	count=1000
Reconstruction for block 9
Total loss:	1.543 	count=500
Total loss:	1.499 	count=1000
Reconstruction for block 10
Total loss:	0.765 	count=500
Total loss:	0.740 	count=1000
Reconstruction for block 11
Total loss:	0.530 	count=500
Total loss:	0.517 	count=1000
Reconstruction for layer head
Total loss:	2.267 	count=500
Total loss:	1.656 	count=1000
Acc after Stage One: 
Test: [0/250]	Time 2.474 (2.474)	Loss 1.0589 (1.0589)	Prec@1 77.500 (77.500)	Prec@5 96.500 (96.500)
Test: [100/250]	Time 0.200 (0.234)	Loss 2.0643 (1.2433)	Prec@1 50.000 (72.045)	Prec@5 82.000 (92.084)
Test: [200/250]	Time 0.199 (0.220)	Loss 0.8921 (1.5680)	Prec@1 84.000 (66.169)	Prec@5 94.500 (87.794)
 * Prec@1 65.584 Prec@5 87.414 Time 54.073

Stage Two, reparameterization
Stage Three, Q-Act, Q-W
Init quantization parameters of weight
re optimization
Reconstruction for layer proj
Total loss:	1.770 	count=500
Total loss:	0.331 	count=1000
Reconstruction for block 0
Total loss:	5.681 	count=500
Total loss:	4.520 	count=1000
Reconstruction for block 1
Total loss:	4.507 	count=500
Total loss:	4.214 	count=1000
Reconstruction for block 2
Total loss:	4.960 	count=500
Total loss:	4.592 	count=1000
Reconstruction for block 3
Total loss:	5.716 	count=500
Total loss:	5.439 	count=1000
Reconstruction for block 4
Total loss:	6.514 	count=500
Total loss:	6.434 	count=1000
Reconstruction for block 5
Total loss:	8.358 	count=500
Total loss:	7.966 	count=1000
Reconstruction for block 6
Total loss:	10.619 	count=500
Total loss:	10.232 	count=1000
Reconstruction for block 7
Total loss:	15.052 	count=500
Total loss:	14.661 	count=1000
Reconstruction for block 8
Total loss:	22.216 	count=500
Total loss:	21.851 	count=1000
Reconstruction for block 9
Total loss:	29.691 	count=500
Total loss:	31.028 	count=1000
Reconstruction for block 10
Total loss:	34.759 	count=500
Total loss:	34.237 	count=1000
Reconstruction for block 11
Total loss:	35.124 	count=500
Total loss:	34.931 	count=1000
Reconstruction for layer head
Total loss:	120.574 	count=500
Total loss:	102.253 	count=1000
Acc after re optimization
Test: [0/250]	Time 2.182 (2.182)	Loss 1.1576 (1.1576)	Prec@1 71.000 (71.000)	Prec@5 95.000 (95.000)
Test: [100/250]	Time 0.207 (0.237)	Loss 2.3141 (1.4432)	Prec@1 51.500 (70.257)	Prec@5 77.000 (90.990)
Test: [200/250]	Time 0.207 (0.224)	Loss 1.0233 (1.7586)	Prec@1 84.500 (64.234)	Prec@5 96.000 (86.410)
 * Prec@1 63.568 Prec@5 85.970 Time 55.182

