Namespace(model='deit_small', dataset='data/ImageNet', calib_batchsize=1024, val_batchsize=200, num_workers=8, device='cuda', print_freq=100, seed=0, w_bits=4, a_bits=4, w_cw=True, a_cw=True, iter=1000, warmup=0.2)
Building dataloader ...
Building model ...
quantization settings: {'n_bits': 4, 'channel_wise': True} | {'n_bits': 4, 'channel_wise': True}

Stage One, Q-Act, FP-W
Init quantization parameters of act
Best base: 2.00000, Best bias: 0.00100, Best score: 0.00004
post-GELU
Best base: 2.00000, Best bias: 0.17100, Best score: 0.00983
Best base: 2.00000, Best bias: 0.00100, Best score: 0.00005
post-GELU
Best base: 2.00000, Best bias: 0.20000, Best score: 0.00307
Best base: 2.00000, Best bias: 0.00500, Best score: 0.00004
post-GELU
Best base: 2.00000, Best bias: 0.20000, Best score: 0.00267
Best base: 2.00000, Best bias: 0.00500, Best score: 0.00001
post-GELU
Best base: 2.00000, Best bias: 0.18000, Best score: 0.00254
Best base: 2.00000, Best bias: 0.00100, Best score: 0.00001
post-GELU
Best base: 2.00000, Best bias: 0.22000, Best score: 0.00305
Best base: 2.00000, Best bias: 0.00500, Best score: 0.00002
post-GELU
Best base: 2.00000, Best bias: 0.17100, Best score: 0.00260
Best base: 2.00000, Best bias: 0.00100, Best score: 0.00001
post-GELU
Best base: 2.00000, Best bias: 0.22000, Best score: 0.00372
Best base: 2.00000, Best bias: 0.00500, Best score: 0.00001
post-GELU
Best base: 2.00000, Best bias: 0.27000, Best score: 0.00344
Best base: 2.00000, Best bias: 0.00500, Best score: 0.00001
post-GELU
Best base: 2.00000, Best bias: 0.17100, Best score: 0.00584
Best base: 2.00000, Best bias: 0.00500, Best score: 0.00001
post-GELU
Best base: 2.00000, Best bias: 0.27000, Best score: 0.00312
Best base: 2.00000, Best bias: 0.00500, Best score: 0.00001
post-GELU
Best base: 2.00000, Best bias: 0.27000, Best score: 0.00100
Best base: 2.00000, Best bias: 0.00500, Best score: 0.00001
post-GELU
Best base: 2.00000, Best bias: 0.27000, Best score: 0.00122
Start optimization
Reconstruction for layer proj
Total loss:	0.000 	count=500
Total loss:	0.000 	count=1000
Reconstruction for block 0
Total loss:	8.357 	count=500
Total loss:	8.148 	count=1000
Reconstruction for block 1
Total loss:	3.139 	count=500
Total loss:	3.051 	count=1000
Reconstruction for block 2
Total loss:	3.135 	count=500
Total loss:	3.091 	count=1000
Reconstruction for block 3
Total loss:	2.689 	count=500
Total loss:	2.624 	count=1000
Reconstruction for block 4
Total loss:	3.250 	count=500
Total loss:	3.208 	count=1000
Reconstruction for block 5
Total loss:	4.426 	count=500
Total loss:	4.403 	count=1000
Reconstruction for block 6
Total loss:	5.564 	count=500
Total loss:	5.413 	count=1000
Reconstruction for block 7
Total loss:	6.275 	count=500
Total loss:	6.345 	count=1000
Reconstruction for block 8
Total loss:	8.332 	count=500
Total loss:	7.814 	count=1000
Reconstruction for block 9
Total loss:	5.621 	count=500
Total loss:	5.588 	count=1000
Reconstruction for block 10
Total loss:	3.801 	count=500
Total loss:	3.583 	count=1000
Reconstruction for block 11
Total loss:	4.507 	count=500
Total loss:	4.358 	count=1000
Reconstruction for layer head
Total loss:	10.345 	count=500
Total loss:	9.214 	count=1000
Acc after Stage One: 
Test: [0/250]	Time 3.879 (3.879)	Loss 0.6033 (0.6033)	Prec@1 85.500 (85.500)	Prec@5 99.000 (99.000)
Test: [100/250]	Time 0.540 (0.912)	Loss 1.2272 (0.8187)	Prec@1 69.000 (81.257)	Prec@5 91.500 (95.807)
Test: [200/250]	Time 0.983 (0.913)	Loss 0.5562 (1.0133)	Prec@1 88.000 (76.719)	Prec@5 96.500 (93.383)
 * Prec@1 76.124 Prec@5 93.154 Time 231.829

Stage Two, reparameterization
Stage Three, Q-Act, Q-W
Init quantization parameters of weight
re optimization
Reconstruction for layer proj
Total loss:	3.232 	count=500
Total loss:	0.507 	count=1000
Reconstruction for block 0
Total loss:	9.985 	count=500
Total loss:	8.581 	count=1000
Reconstruction for block 1
Total loss:	10.689 	count=500
Total loss:	10.155 	count=1000
Reconstruction for block 2
Total loss:	15.153 	count=500
Total loss:	14.675 	count=1000
Reconstruction for block 3
Total loss:	21.023 	count=500
Total loss:	21.332 	count=1000
Reconstruction for block 4
Total loss:	35.012 	count=500
Total loss:	35.366 	count=1000
Reconstruction for block 5
Total loss:	61.144 	count=500
Total loss:	63.860 	count=1000
Reconstruction for block 6
Total loss:	98.581 	count=500
Total loss:	96.217 	count=1000
Reconstruction for block 7
Total loss:	134.148 	count=500
Total loss:	132.364 	count=1000
Reconstruction for block 8
Total loss:	172.127 	count=500
Total loss:	170.910 	count=1000
Reconstruction for block 9
Total loss:	203.722 	count=500
Total loss:	213.253 	count=1000
Reconstruction for block 10
Total loss:	214.543 	count=500
Total loss:	208.308 	count=1000
Reconstruction for block 11
Total loss:	211.920 	count=500
Total loss:	211.821 	count=1000
Reconstruction for layer head
Total loss:	174.764 	count=500
Total loss:	164.195 	count=1000
Acc after re optimization
Test: [0/250]	Time 3.381 (3.381)	Loss 0.7519 (0.7519)	Prec@1 85.500 (85.500)	Prec@5 99.000 (99.000)
Test: [100/250]	Time 0.850 (0.939)	Loss 1.4058 (0.9923)	Prec@1 63.500 (80.188)	Prec@5 91.000 (95.450)
Test: [200/250]	Time 1.424 (1.161)	Loss 0.6352 (1.1777)	Prec@1 92.500 (75.858)	Prec@5 96.500 (93.102)
 * Prec@1 75.356 Prec@5 92.920 Time 303.039

