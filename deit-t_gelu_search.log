Namespace(model='deit_tiny', dataset='data/ImageNet', calib_batchsize=1024, val_batchsize=200, num_workers=8, device='cuda', print_freq=100, seed=0, w_bits=4, a_bits=4, w_cw=True, a_cw=True, iter=1000, warmup=0.2)
Building dataloader ...
Building model ...
quantization settings: {'n_bits': 4, 'channel_wise': True} | {'n_bits': 4, 'channel_wise': True}

Stage One, Q-Act, FP-W
Init quantization parameters of act
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
post-GELU
Best base: 1.20000, Best bias: 0.37000, Best score: 0.00304
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
post-GELU
Best base: 1.25000, Best bias: 0.37000, Best score: 0.00086
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
post-GELU
Best base: 1.20000, Best bias: 0.19000, Best score: 0.00081
Best base: 1.20000, Best bias: 0.01000, Best score: 0.00001
post-GELU
Best base: 1.20000, Best bias: 0.20000, Best score: 0.00066
Best base: 1.20000, Best bias: 0.00500, Best score: 0.00000
post-GELU
Best base: 1.20000, Best bias: 0.21000, Best score: 0.00062
Best base: 1.20000, Best bias: 0.01000, Best score: 0.00001
post-GELU
Best base: 1.35000, Best bias: 0.22000, Best score: 0.00054
Best base: 1.20000, Best bias: 0.00500, Best score: 0.00000
post-GELU
Best base: 1.30000, Best bias: 0.27000, Best score: 0.00082
Best base: 1.30000, Best bias: 0.02000, Best score: 0.00001
post-GELU
Best base: 1.40000, Best bias: 0.20000, Best score: 0.00089
Best base: 1.20000, Best bias: 0.01000, Best score: 0.00001
post-GELU
Best base: 1.20000, Best bias: 0.20000, Best score: 0.00079
Best base: 1.20000, Best bias: 0.01000, Best score: 0.00001
post-GELU
Best base: 1.20000, Best bias: 0.27000, Best score: 0.00055
Best base: 1.20000, Best bias: 0.01000, Best score: 0.00000
post-GELU
Best base: 1.25000, Best bias: 0.22000, Best score: 0.00026
Best base: 1.40000, Best bias: 0.00500, Best score: 0.00001
post-GELU
Best base: 1.25000, Best bias: 0.27000, Best score: 0.00026
Start optimization
Reconstruction for layer proj
Total loss:	0.000 	count=500
Total loss:	0.000 	count=1000
Reconstruction for block 0
Total loss:	3.204 	count=500
Total loss:	3.008 	count=1000
Reconstruction for block 1
Total loss:	1.254 	count=500
Total loss:	1.249 	count=1000
Reconstruction for block 2
Total loss:	0.921 	count=500
Total loss:	0.918 	count=1000
Reconstruction for block 3
Total loss:	0.701 	count=500
Total loss:	0.696 	count=1000
Reconstruction for block 4
Total loss:	0.649 	count=500
Total loss:	0.643 	count=1000
Reconstruction for block 5
Total loss:	0.764 	count=500
Total loss:	0.761 	count=1000
Reconstruction for block 6
Total loss:	1.067 	count=500
Total loss:	1.047 	count=1000
Reconstruction for block 7
Total loss:	1.514 	count=500
Total loss:	1.473 	count=1000
Reconstruction for block 8
Total loss:	1.625 	count=500
Total loss:	1.626 	count=1000
Reconstruction for block 9
Total loss:	1.316 	count=500
Total loss:	1.274 	count=1000
Reconstruction for block 10
Total loss:	0.749 	count=500
Total loss:	0.709 	count=1000
Reconstruction for block 11
Total loss:	0.625 	count=500
Total loss:	0.655 	count=1000
Reconstruction for layer head
Total loss:	27.495 	count=500
Total loss:	32.010 	count=1000
Acc after Stage One: 
Test: [0/250]	Time 2.843 (2.843)	Loss 0.9013 (0.9013)	Prec@1 80.000 (80.000)	Prec@5 97.000 (97.000)
Test: [100/250]	Time 0.454 (0.425)	Loss 1.7121 (1.1501)	Prec@1 58.000 (74.782)	Prec@5 84.500 (93.203)
Test: [200/250]	Time 0.470 (0.447)	Loss 0.7719 (1.4189)	Prec@1 86.000 (69.070)	Prec@5 95.500 (89.500)
 * Prec@1 68.414 Prec@5 89.162 Time 112.704

Stage Two, reparameterization
Stage Three, Q-Act, Q-W
Init quantization parameters of weight
re optimization
Reconstruction for layer proj
Total loss:	1.929 	count=500
Total loss:	0.389 	count=1000
Reconstruction for block 0
Total loss:	4.436 	count=500
Total loss:	3.818 	count=1000
Reconstruction for block 1
Total loss:	4.117 	count=500
Total loss:	3.990 	count=1000
Reconstruction for block 2
Total loss:	4.897 	count=500
Total loss:	4.679 	count=1000
Reconstruction for block 3
Total loss:	5.811 	count=500
Total loss:	5.705 	count=1000
Reconstruction for block 4
Total loss:	7.356 	count=500
Total loss:	6.916 	count=1000
Reconstruction for block 5
Total loss:	9.461 	count=500
Total loss:	9.066 	count=1000
Reconstruction for block 6
Total loss:	13.149 	count=500
Total loss:	13.037 	count=1000
Reconstruction for block 7
Total loss:	19.243 	count=500
Total loss:	18.950 	count=1000
Reconstruction for block 8
Total loss:	32.190 	count=500
Total loss:	30.966 	count=1000
Reconstruction for block 9
Total loss:	45.360 	count=500
Total loss:	46.397 	count=1000
Reconstruction for block 10
Total loss:	54.248 	count=500
Total loss:	52.211 	count=1000
Reconstruction for block 11
Total loss:	53.469 	count=500
Total loss:	53.871 	count=1000
Reconstruction for layer head
Total loss:	201.453 	count=500
Total loss:	191.336 	count=1000
Acc after re optimization
Test: [0/250]	Time 2.771 (2.771)	Loss 1.0545 (1.0545)	Prec@1 77.500 (77.500)	Prec@5 94.500 (94.500)
Test: [100/250]	Time 0.485 (0.433)	Loss 1.7372 (1.2469)	Prec@1 57.500 (73.624)	Prec@5 83.000 (92.673)
Test: [200/250]	Time 0.475 (0.453)	Loss 0.8424 (1.5188)	Prec@1 86.000 (68.012)	Prec@5 95.500 (88.813)
 * Prec@1 67.358 Prec@5 88.458 Time 114.287

